notifications:
  email:
    on_success: never
    on_failure: change
sudo: false
language: python
cache: pip
before_cache:
- rm -f $HOME/.cache/pip/log/debug.log
env:
  global:
  - secure: f4hQQE4qMRQOuJwsjO4gm+OtJ5FlmbAZRh8377+5W4kjqzPyY30fPdV3wUnhhIQGdGiHkhfv0DiJ/abb0DKYmPG84H4ADLNyQ0qArAMtsHLucEB88kFHlYDLeKHM4jIM6PpoSzqg+ifojwspY4HbyUHnBZZdmhmrPCH+rsPCKEdu3bQFWJO6GfTLiE+gu2fu8GwyBgdhpebhqSO0O2i1wzanIEGBjkuaq5oVZ44GGKxC6Nk/Pa/JTKGNipVMHSxLOAqV3bsRLBR+LBi/MCdHISpCH8lZs9NOaL9u5sLNY3ueY4DzRdIODr5kicZkOjKD17IRjlQrKpvz6rTm3UNa7+hdWXb9ElVo8ViTx2vjloxxA4NW34WPpcYz3FxFUQ/M3tiTAPl/8R+jdbEO2kTTNjsVdtV1zWP+VbnhuSnKXVDp0wJ1fKhCjgUs1KkwxZ9yAaQF1s9yUePA815b62BgStzui/MyXVifT1dy5tYzQLhD5Q0bPTyBwEJaz7vwImAPh6LVRxQhAQJmKuhKcq6GqBS4KSXEXWbUAIaFJ0PYmhZPMetCcYrEmoqiPiGsu3tlpLDvZx/2+PsZ/LK54xgjzAoG2z6PBowpXsk6+KjJgRF32KjYl+vv0olU4aAehQRsYQGCSuciQ7PCaKwIcLItGdajk1zu8wtiqSa+7hKud4c=
before_install:
- if [ -z "$GITHUB_ACCESS_TOKEN" ]; then echo "Environment requires access token"
  && exit 1; fi
install:
- pip install -r dev-requirements.txt
after_success:
- tox -e coverage-report
jobs:
  include:
  - stage: lint
    python: '3.6'
    script: make lint
  - stage: test
    python: '3.6'
    env: TOXENV=py36
    script: make test
  - stage: release
    python: 3.6
    before_install: skip
    after_success: skip
    script: echo "Running the script"
    before_deploy:
    - if [ -z "$TWINE_USERNAME" ]; then exit 1; fi
    - if [ -z "$TWINE_PASSWORD" ]; then exit 1; fi
    - if [ -z "$GITHUB_TAG_TOKEN" ]; then exit 1; fi
    - git config --global user.email "builds@travis-ci.com"
    - git config --global user.name "Travis CI"
    - pip install -r dev-requirements.txt
    - git status
    deploy:
    - "./travis-pypi-release.sh"
    - pip install gh2md --upgrade
    env:
    - secure: 3MFAF/eQLEJIdGYcEWpe1TbEAIUH9/lbaeDdG7obw6Tkwa8vwM0Ji8hvvUtn781qDpcoy0eLbkoUKxmTr06S9ipsj0e/WR4dNH+jOCfr04JJW4JSxFJGP80FFqh/zsIRvBJjCD/l4D22FkYSzLXTV9vM7v6gWvdPHhu/m0lTlF5DXDpOHDFXLi6m/2uEPpnAb+B64L0MQMR+2gk5kFi3ueOztXooXvNA+IR7gC/70TXwAUbpD9le9zi0bYVyfohDNdlgwgX5SFkGRyjFw3lTguRTFm/Nu4u/Ln+TwKIBoKf94IwJAiFgNsfTMGCXGVz689Z7SrqgvRmWKxrjkoS/MZ1+w7fE76t8udJeBYqAIzXZEawGDmRFWgUgEQk3ZdplA2j9eofm1NMnM4ZwWMh1zBG3sDzbqR09S0KjpoeMjgXQ2la8iw5noh0KPaGT9fz29fJpiRxkfvmAsT72QIQ6wmh2HBNuwMDXc/lJdWoPgRqOGxYOwLraCXnqLqVYA3tJkL2KkLur0iWBkaXS3yBVNvG/C/zY6o1J0ykhdwBA1B6o0Z5Q497lL4wqymJdvBw3Lg3bVYGCW/pjRkLNPQ2qgZ26BewIO0P8dNeXHJMs0FPVU/Ok2sfqoAc0igxSgAVN/nAkDf+cVSXZmHAKfOexcz+YjuiKsaXXiFJs6ZyE59E=
    - secure: TCFcv8rBEpJUbrCzCuMA4cqTYehK+HOzZGEo3AhJ/cKXUhoNkLkJ4Jid0+7sKlfZw3BlASUNNt993StVzEIfePbJ4CwKJ2utUudhXFqlqFZx/vI3NUapo53oNB0NH3r+v1yyvDRJscy1AE24IIMSD2KtoaeDGAO8KLwZMhhgVsvSCnrHNma8F/QWKnPYA2gg1Wmj3iXxO7NHELwQRYSs3hfERUIv97Lf7gf5wjGDocrTsFcnHxAxgGC55obXymST4Wn9lKEqyKBQv/6WcYHaGrfRN42GZEbiSzY7XHyzsrj9dVBiU7vK47QsmIR9qW8MMFPiyHYLTtit3xeNzP6L9NuLphku/wDTrfR1OlAVd7H+kNcw4fnlF0ar3I6OL5KyvorNh3zKzs0WLmxRLi1NN1mkWVkoYbgGplmy9yjZ52VM8U2tJhUvrG1ZiDH9atWLvn+dcEK5k9yfXjJqmGh4L+5GtOJhGsiuNMg2IrFD4Ef8nXRNLJI22BSkmBK6pjZCKFHyxkb6EQkACm7PkjXKvQARlcpKaNjUMYrAdeZVDOumc6pOGL+jCuAmHclhh6rMiICPYlGmXAzIQcG8dPDlGfErhvRBV7oJQh3IPL4wk0YnmZ3a/OMPdG7mzL2UnVspN/YW0eMqaKuPWIxPey+ciWiH1Wrv9CNhCUCITxIg2ks=
    - secure: qRbj71375w7jHenCOdxvF2mEbLH6KYD+QBmVXZnaRB4R3WdS1ghThYwzTBmalBVFqQ2E3LOTY4TIvhCxPIhPaTyRi2kHXKGke6NR4z/rlbMLYm9VRBLG+4dT9LuRYW0xH1XPmo54OCLdS1zPASV5pXoanMwFqKgerfoUjX8WWM/yNz37j4VflBVVQ9lKGsfwbDyK7XpN3kOO4oiC9tFTnzGc6zS7vxfHkqCEB/otPKBdkFED8ZwmaJ0D20MOE619YTMtf0mwxL+PyIEtIO+ocpmfLJILseEicoFrDOgcoJZv2ZS30nsu2MQHZZxvMmI0NNn7fMjMVqdQ5fCPm9V/ASg/b6fqdllDBuSHNyb1sX6ZzVBYPY8RsnjOxZNQzw++ZTOqFW9LF5rADjcUvCcS44Ue8rCL3q7Ob7Xw5fXW0EDqLioTooCsPK00qrPl1s9/bMrhXqRWGv23qcexzwAt7MsqiORhi82Kj3ks9Zn9y4e4qNxtgikQaULXVAUcAsnBRwEm+XHdBWo8FpPi1GFeX+cc73k9+e0lGCMS6LnQsYDaRPPwkfjfXi3IA26obxE6hoPtyQ39PWB0YFVTg9vQmZFA1uFwQXoF2JPIw//Iy50BF9SvJ6xJwWJ4AHeYnDK2rOcGK0cxWSzyl/zmWrb91uBOMnXioxhLA0clWcP+QmI=
